<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>해수어항 관리 도징 계산기</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .result-item { padding: 0.75rem; border-radius: 0.5rem; margin-bottom: 0.5rem; font-weight: 500; }
    .result-good  { background-color: #E6FFFA; color: #234E52; border-left: 4px solid #38B2AC; }
    .result-low   { background-color: #FFF5F5; color: #C53030; border-left: 4px solid #FC8181; }
    .result-high  { background-color: #FAF5FF; color: #6B46C1; border-left: 4px solid #B794F4; }
    .result-action{ background-color: #FEFCBF; color: #744210; border-left: 4px solid #F6E05E; }
  </style>
</head>
<body class="bg-gray-100 font-sans">
  <div class="container mx-auto p-4 max-w-5xl">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-bold mb-4">어항 정보 입력</h2>
        <div class="grid grid-cols-2 gap-3">
          <input id="date" type="date" class="border p-2 rounded" />
          <input id="vol" placeholder="용량(L)" class="border p-2 rounded" value="160" />
          <input id="temp" placeholder="온도(°C)" class="border p-2 rounded" />
          <input id="salinity" placeholder="염도(ppt)" class="border p-2 rounded" />
          <input id="ph" placeholder="pH" class="border p-2 rounded" />
          <input id="ca" placeholder="Ca(ppm)" class="border p-2 rounded" />
          <input id="mg" placeholder="Mg(ppm)" class="border p-2 rounded" />
          <input id="kh" placeholder="KH(dKH)" class="border p-2 rounded" />
          <input id="no2" placeholder="NO₂(ppm)" class="border p-2 rounded" />
          <input id="no3" placeholder="NO₃(ppm)" class="border p-2 rounded" />
          <input id="po4" placeholder="PO₄(ppm)" class="border p-2 rounded" />
        </div>
        <div class="flex flex-wrap space-x-2 mt-4">
          <button id="calculate-btn" class="flex-1 bg-blue-600 text-white py-2 rounded">계산하기</button>
          <button id="save-btn" class="flex-1 bg-green-600 text-white py-2 rounded">기록 저장</button>
          <button id="graph-btn" class="flex-1 bg-purple-600 text-white py-2 rounded">그래프 보기</button>
          <button id="ai-btn" class="flex-1 bg-indigo-600 text-white py-2 rounded">AI 어드바이스</button>
        </div>
      </div>

      <div class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-bold mb-4">계산 결과 및 권장 사항</h2>
        <div id="results-output" class="space-y-2"></div>
      </div>
    </div>

    <div class="mt-8 bg-white p-6 rounded shadow">
      <div class="flex justify-between mb-4">
        <h2 class="text-xl font-bold">저장된 기록</h2>
        <div class="space-x-2">
          <button id="clear-logs-btn" class="bg-red-500 text-white px-4 py-2 rounded">기록 초기화</button>
        </div>
      </div>
      <table class="w-full text-sm">
        <thead><tr><th>날짜</th><th>온도</th><th>염도</th><th>pH</th><th>Ca</th><th>Mg</th><th>KH</th><th>NO₂</th><th>NO₃</th><th>PO₄</th><th>삭제</th></tr></thead>
        <tbody id="log-table-body"></tbody>
      </table>
    </div>
  </div>

  <script>
    const graphWindowFeatures = 'width=900,height=600,resizable,scrollbars';
    const aiWindowFeatures = 'width=600,height=400,resizable,scrollbars';

    document.getElementById('graph-btn').onclick = () => {
      const graphWin = window.open('', '그래프보기', graphWindowFeatures);
      graphWin.document.write('<h1>그래프 기능은 곧 구현될 예정입니다.</h1>');
    };

    document.getElementById('ai-btn').onclick = () => {
      const aiWin = window.open('', 'AI어드바이스', aiWindowFeatures);
      aiWin.document.write('<h1>AI 어드바이스 기능은 곧 구현될 예정입니다.</h1>');
    };

    document.getElementById('calculate-btn').onclick = () => {
      const vol = parseFloat(document.getElementById('vol').value);
      const ca = parseFloat(document.getElementById('ca').value);
      const mg = parseFloat(document.getElementById('mg').value);
      const kh = parseFloat(document.getElementById('kh').value);
      const no3 = parseFloat(document.getElementById('no3').value);
      const po4 = parseFloat(document.getElementById('po4').value);
      const no2 = parseFloat(document.getElementById('no2').value);
      const temp = parseFloat(document.getElementById('temp').value);
      const salinity = parseFloat(document.getElementById('salinity').value);
      const ph = parseFloat(document.getElementById('ph').value);

      const resultDiv = document.getElementById('results-output');
      resultDiv.innerHTML = '';

      function addResult(label, value, range, status) {
        const div = document.createElement('div');
        div.className = `result-item result-${status}`;
        div.textContent = `${label}: ${value} → ${range}`;
        resultDiv.appendChild(div);
      }

      if (!isNaN(temp)) addResult('온도', temp + '°C', '26.0±0.5°C', (temp < 25.5 || temp > 26.5) ? 'action' : 'good');
      if (!isNaN(salinity)) addResult('염도', salinity + 'ppt', '34~35ppt', (salinity < 34 || salinity > 35) ? 'action' : 'good');
      if (!isNaN(ph)) addResult('pH', ph, '8.0~8.3', (ph < 8.0 || ph > 8.3) ? 'action' : 'good');
      if (!isNaN(ca)) addResult('칼슘(Ca)', ca + 'ppm', '목표 430ppm', (ca < 415) ? 'low' : (ca > 445 ? 'high' : 'good'));
      if (!isNaN(mg)) addResult('마그네슘(Mg)', mg + 'ppm', '목표 1440ppm', (mg < 1400) ? 'low' : (mg > 1480 ? 'high' : 'good'));
      if (!isNaN(kh)) addResult('KH', kh + 'dKH', '목표 8.0', (kh < 7.7) ? 'low' : (kh > 8.3 ? 'high' : 'good'));
      if (!isNaN(no2)) addResult('NO₂', no2 + 'ppm', '0.00ppm 권장', (no2 > 0.00) ? 'action' : 'good');
      if (!isNaN(no3)) addResult('NO₃', no3 + 'ppm', '0.5~2.0ppm', (no3 < 0.5) ? 'low' : (no3 > 2.0 ? 'high' : 'good'));
      if (!isNaN(po4)) addResult('PO₄', po4 + 'ppm', '0.03~0.08ppm', (po4 < 0.03) ? 'low' : (po4 > 0.08 ? 'high' : 'good'));
    };
  </script>
</body>
</html>
