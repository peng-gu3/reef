<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì£¼ì‹ ë§¤ë§¤ì¼ì§€</title>
<link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
<style>
:root{
--primary:#2563eb;
--red:#f87171; --red-bg:#fef2f2; --red-text:#b91c1c;
--blue:#60a5fa; --blue-bg:#eff6ff; --blue-text:#1d4ed8;
--gray:#64748b; --gray-bg:#f1f5f9; --gray-text:#334155;
--green-bg:#f0fdf4; --green-text:#166534; --green-border:#22c55e;
--bg:#f8fafc; --surface:#fff;
--text-main:#1e293b; --text-sub:#64748b;
--border:#e2e8f0;
--shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06);
}
body{font-family:Pretendard,sans-serif;background:var(--bg);margin:0;padding:40px 20px}
.container{max-width:1100px;margin:auto}
.main-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.main-title{font-size:24px;font-weight:800}
.data-controls button{padding:8px 12px;border-radius:8px;border:1px solid var(--border);background:#fff;cursor:pointer;font-weight:600;font-size:13px}
.summary-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:15px;margin-bottom:20px}
.stat-card{background:#fff;padding:20px;border-radius:16px;border:1px solid var(--border);box-shadow:var(--shadow)}
.stat-card h3{font-size:13px;color:var(--text-sub);margin:0 0 6px}
.stat-card p{font-size:22px;font-weight:800;margin:0}
.text-up{color:var(--red-text)}
.text-down{color:var(--blue-text)}

.calendar-header{display:flex;justify-content:space-between;align-items:center;background:#fff;padding:15px 20px;border-radius:16px;border:1px solid var(--border);box-shadow:var(--shadow)}
.btn-nav{background:var(--bg);border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-weight:600}
.calendar-wrapper{margin-top:10px;background:#fff;padding:20px;border-radius:16px;border:1px solid var(--border);box-shadow:var(--shadow)}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:10px}
.day-header{text-align:center;font-weight:600;color:var(--text-sub)}
.day{border:1px solid var(--border);border-radius:12px;min-height:110px;padding:8px;cursor:pointer}
.day.today{border-color:var(--primary)}
.day-num{font-size:14px;font-weight:600;color:var(--text-sub)}
.badge{font-size:11px;padding:5px 8px;border-radius:6px;margin-top:4px}
.badge.buy{background:var(--red-bg);color:var(--red-text)}
.badge.sell-profit{background:#fff1f2;color:#be123c}
.badge.sell-loss{background:#eff6ff;color:#1d4ed8}
.badge.other{background:var(--gray-bg);color:var(--gray-text)}
.badge.deposit{background:var(--green-bg);color:var(--green-text);border-left:3px solid var(--green-border)}

.modal-overlay{display:none;position:fixed;inset:0;background:rgba(15,23,42,.4);backdrop-filter:blur(4px);justify-content:center;align-items:center}
.modal{background:#fff;border-radius:20px;width:480px;max-width:95%;max-height:85vh;overflow:hidden;display:flex;flex-direction:column}
.modal-header{padding:15px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between}
.modal-body{padding:20px;overflow-y:auto}
.form-group{margin-bottom:12px}
.form-group label{font-size:13px;font-weight:600;color:var(--text-sub)}
.form-group input,.form-group select{width:100%;padding:10px;border:1px solid var(--border);border-radius:8px}
.btn-group{display:flex;gap:10px;margin-top:15px}
.btn{flex:1;padding:12px;border:none;border-radius:8px;font-weight:700;cursor:pointer}
.btn-save{background:#111827;color:#fff}
.btn-close{background:#e5e7eb}

.log-item{border:1px solid var(--border);border-radius:10px;padding:10px;margin-bottom:8px;display:flex;justify-content:space-between}
.log-title{font-weight:700;font-size:14px}
.log-desc{font-size:12px;color:var(--text-sub)}
.green-text{color:var(--green-text);font-weight:600}
</style>
</head>

<body>
<div class="container">
<div class="main-header">
<h1 class="main-title">í•˜ë£¨ 20ë§Œ ëª©í‘œ!!!</h1>
<div class="data-controls">
<button onclick="exportData()">ğŸ’¾ ë°±ì—…</button>
<button onclick="document.getElementById('fileInput').click()">ğŸ“‚ ë³µêµ¬</button>
<input type="file" id="fileInput" hidden onchange="importData(this)">
</div>
</div>

<div class="summary-grid">
<div class="stat-card"><h3>ì´ ëˆ„ì  ì†ìµ</h3><p id="totalProfit">0ì›</p></div>
<div class="stat-card"><h3>ì´ë²ˆ ë‹¬ ìˆ˜ìµ</h3><p id="monthProfit">0ì›</p></div>
<div class="stat-card"><h3>í‰ê·  ì†ìµ</h3><p id="avgProfit">0ì›</p></div>
<div class="stat-card"><h3>ë² ìŠ¤íŠ¸ ì¢…ëª©</h3><p id="bestStock">-</p></div>
</div>

<div class="calendar-header">
<button class="btn-nav" onclick="changeMonth(-1)">â—€</button>
<h2 id="currentMonthLabel"></h2>
<button class="btn-nav" onclick="changeMonth(1)">â–¶</button>
</div>
<div class="calendar-wrapper">
<div class="calendar" id="calendarGrid"></div>
</div>
</div>

<script>
let currentDate=new Date();
let transactions=JSON.parse(localStorage.getItem('stockData_final'))||[];

function formatMoney(n){return n.toLocaleString()+'ì›'}

function updateSummary(){
let tp=0,mp=0,sc=0,sum=0,best=-1,bestName='-';
let cm=`${currentDate.getFullYear()}-${String(currentDate.getMonth()+1).padStart(2,'0')}`;
transactions.forEach(t=>{
if(t.type==='sell'){tp+=t.profit;sum+=t.profit;sc++;if(t.date.startsWith(cm))mp+=t.profit;if(t.profit>best){best=t.profit;bestName=t.name}}
if(t.type==='other'){tp+=t.price;if(t.date.startsWith(cm))mp+=t.price}
});
document.getElementById('totalProfit').innerText=formatMoney(tp);
document.getElementById('monthProfit').innerText=formatMoney(mp);
document.getElementById('avgProfit').innerText=formatMoney(sc?Math.round(sum/sc):0);
document.getElementById('bestStock').innerText=best>0?bestName:'-';
}

function renderCalendar(){
const grid=document.getElementById('calendarGrid');
grid.innerHTML='';
const y=currentDate.getFullYear(),m=currentDate.getMonth();
document.getElementById('currentMonthLabel').innerText=`${y}ë…„ ${m+1}ì›”`;
['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '].forEach(d=>grid.innerHTML+=`<div class="day-header">${d}</div>`);
const first=new Date(y,m,1).getDay();
const last=new Date(y,m+1,0).getDate();
for(let i=0;i<first;i++)grid.innerHTML+='<div></div>';
for(let d=1;d<=last;d++){
const ds=`${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
let logs=transactions.filter(t=>t.date===ds);
let html=`<div class="day"><div class="day-num">${d}</div>`;
logs.forEach(l=>{
if(l.type==='buy')html+=`<div class="badge buy">${l.name}</div>`;
if(l.type==='sell')html+=`<div class="badge ${l.profit>=0?'sell-profit':'sell-loss'}">${l.name}</div>`;
if(l.type==='other')html+=`<div class="badge ${l.price>0?'deposit':'other'}">${l.name}</div>`;
});
grid.innerHTML+=html+'</div>';
}
}

function changeMonth(v){currentDate.setMonth(currentDate.getMonth()+v);renderCalendar();updateSummary()}
function exportData(){const d=JSON.stringify(transactions);const a=document.createElement('a');a.href='data:application/json,'+encodeURIComponent(d);a.download='stock_backup.json';a.click()}
function importData(i){const r=new FileReader();r.onload=e=>{transactions=JSON.parse(e.target.result);localStorage.setItem('stockData_final',JSON.stringify(transactions));location.reload()};r.readAsText(i.files[0])}

renderCalendar();updateSummary();
</script>
</body>
</html>
