<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>주식 매매일지</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css">

<style>
:root{
--bg:#f8fafc;--card:#fff;--border:#e2e8f0;
--text:#1e293b;--sub:#64748b;
--red:#ef4444;--blue:#2563eb;--green:#16a34a;
}
*{box-sizing:border-box}
body{
margin:0;padding:30px;font-family:Pretendard;background:var(--bg);color:var(--text)
}
.container{max-width:1100px;margin:auto}

h1{margin:0 0 20px;font-size:24px}

.calendar-header{
display:flex;justify-content:space-between;align-items:center;
background:var(--card);padding:15px 20px;border-radius:14px;
border:1px solid var(--border);margin-bottom:15px
}
.calendar{
display:grid;grid-template-columns:repeat(7,1fr);gap:10px
}
.day-header{text-align:center;color:var(--sub);font-weight:600}
.day{
background:#fff;border:1px solid var(--border);border-radius:12px;
padding:8px;min-height:120px;cursor:pointer
}
.day:hover{border-color:var(--blue)}
.day-num{font-weight:700;margin-bottom:4px}
.badge{
font-size:11px;padding:4px 6px;border-radius:6px;margin-bottom:3px
}
.buy{background:#fef2f2;color:#b91c1c}
.sell{background:#eff6ff;color:#1d4ed8}
.deposit{background:#f0fdf4;color:#166534;font-weight:600}

.modal-bg{
display:none;position:fixed;inset:0;background:rgba(0,0,0,.4);
align-items:center;justify-content:center
}
.modal{
background:#fff;width:460px;border-radius:16px;
padding:20px
}
.form-group{margin-bottom:10px}
label{font-size:13px;color:var(--sub);display:block;margin-bottom:4px}
input,select{
width:100%;padding:8px;border:1px solid var(--border);border-radius:8px
}
.btns{display:flex;gap:10px;margin-top:15px}
button{
flex:1;padding:10px;border:none;border-radius:8px;
font-weight:600;cursor:pointer
}
.save{background:#1e293b;color:#fff}
.close{background:#e5e7eb}
.log-item{
border:1px solid var(--border);border-radius:10px;
padding:8px;margin-bottom:6px;font-size:13px
}
</style>
</head>

<body>
<div class="container">
<h1>하루 20만 목표!!!</h1>

<div class="calendar-header">
<button onclick="moveMonth(-1)">◀</button>
<div id="monthLabel"></div>
<button onclick="moveMonth(1)">▶</button>
</div>

<div class="calendar" id="calendar"></div>
</div>

<!-- MODAL -->
<div class="modal-bg" id="modal">
<div class="modal">
<h3 id="modalTitle">거래 입력</h3>

<div class="form-group">
<label>날짜</label>
<input type="date" id="fDate">
</div>

<div class="form-group">
<label>구분</label>
<select id="fType" onchange="typeChange()">
<option value="buy">매수</option>
<option value="sell">매도</option>
<option value="deposit">기타(예수금)</option>
</select>
</div>

<div class="form-group">
<label id="nameLabel">종목명</label>
<input id="fName">
</div>

<div class="form-group">
<label id="priceLabel">단가</label>
<input type="number" id="fPrice">
</div>

<div class="form-group" id="qtyWrap">
<label>수량</label>
<input type="number" id="fQty" value="1">
</div>

<div class="btns">
<button class="close" onclick="closeModal()">취소</button>
<button class="save" onclick="save()">저장</button>
</div>

<hr>

<div id="dayLogs"></div>
</div>
</div>

<script>
let cur=new Date();
let data=JSON.parse(localStorage.getItem('trade_log'))||[];
let sellTarget=null;

function moveMonth(d){
cur.setMonth(cur.getMonth()+d);
render();
}

function render(){
const y=cur.getFullYear(),m=cur.getMonth();
document.getElementById('monthLabel').innerText=`${y}년 ${m+1}월`;
const cal=document.getElementById('calendar');
cal.innerHTML=`<div class="day-header">일</div><div class="day-header">월</div><div class="day-header">화</div><div class="day-header">수</div><div class="day-header">목</div><div class="day-header">금</div><div class="day-header">토</div>`;
const first=new Date(y,m,1).getDay();
const last=new Date(y,m+1,0).getDate();
for(let i=0;i<first;i++) cal.innerHTML+=`<div></div>`;
for(let d=1;d<=last;d++){
const ds=`${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
const logs=data.filter(x=>x.date===ds);
let html=`<div class="day" onclick="openModal('${ds}')"><div class="day-num">${d}</div>`;
logs.forEach(l=>{
if(l.type==='buy') html+=`<div class="badge buy">매수 ${l.name}</div>`;
if(l.type==='sell') html+=`<div class="badge sell">매도 ${l.name}</div>`;
if(l.type==='deposit') html+=`<div class="badge deposit">+${l.price.toLocaleString()}</div>`;
});
html+=`</div>`;
cal.innerHTML+=html;
}
}

function openModal(d){
sellTarget=null;
document.getElementById('modal').style.display='flex';
document.getElementById('modalTitle').innerText='거래 입력';
fDate.value=d;fType.value='buy';fName.value='';fPrice.value='';fQty.value=1;
typeChange();
renderLogs(d);
}

function closeModal(){modal.style.display='none'}

function typeChange(){
if(fType.value==='deposit'){
nameLabel.innerText='내용';
priceLabel.innerText='금액';
qtyWrap.style.display='none';
}else{
nameLabel.innerText='종목명';
priceLabel.innerText=fType.value==='buy'?'매수 단가':'매도 단가';
qtyWrap.style.display='block';
}
}

function save(){
const obj={
id:Date.now(),
date:fDate.value,
type:fType.value,
name:fName.value,
price:+fPrice.value,
qty:+fQty.value||1
};
if(obj.type==='deposit') obj.qty=1;
data.push(obj);
localStorage.setItem('trade_log',JSON.stringify(data));
closeModal();render();
}

function renderLogs(d){
const box=document.getElementById('dayLogs');
const logs=data.filter(x=>x.date===d);
box.innerHTML=logs.map(l=>{
if(l.type==='deposit') return `<div class="log-item deposit">예수금 +${l.price.toLocaleString()}</div>`;
return `<div class="log-item">${l.type} ${l.name}</div>`;
}).join('')||'기록 없음';
}

render();
</script>
</body>
</html>
